# üìù –ü–ª–∞–Ω —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ç–µ—Ö–Ω—ñ—á–Ω–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è Data Platform (Orchestrated by Airflow)

–¶–µ–π –ø–ª–∞–Ω –ø–æ–≤–Ω—ñ—Å—Ç—é –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –≤–∏–º–æ–≥–∞–º —â–æ–¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Glue –¥–ª—è Ingestion/Silver —Ç–∞ Redshift –¥–ª—è Gold.

## üèóÔ∏è –ï—Ç–∞–ø 1: Ingestion & Metadata (Airflow & Crawler)
1.  **Airflow Task**: `trigger_crawler` -> –ó–∞–ø—É—Å–∫–∞—î `data-platform-s3-crawler`.
2.  **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –°–∏—Ä—ñ –¥–∞–Ω—ñ –¥–æ—Å—Ç—É–ø–Ω—ñ –≤ –±–∞–∑—ñ `bronze` (Glue Catalog).

## üöÄ –ï—Ç–∞–ø 2: Silver Layer (Airflow & Glue)
1.  **Airflow Task**: `run_sales_etl` -> –ö–æ–º–∞–Ω–¥–∞ Glue Job –æ–±—Ä–æ–±–∏—Ç–∏ `sales`.
2.  **Airflow Task**: `run_customers_etl` -> –ö–æ–º–∞–Ω–¥–∞ Glue Job –æ–±—Ä–æ–±–∏—Ç–∏ `customers`.
3.  **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –û—á–∏—â–µ–Ω—ñ –¥–∞–Ω—ñ –≤ S3 (`silver/` –ø–∞–ø–∫–∞) —É —Ñ–æ—Ä–º–∞—Ç—ñ Parquet.

## üíé –ï—Ç–∞–ø 3: Gold Layer & Enrichment (Airflow & Redshift)
*–ó–≥—ñ–¥–Ω–æ –∑ –≤–∏–º–æ–≥–∞–º–∏ –¢–ó, —Ü–µ–π –µ—Ç–∞–ø –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –≤ Redshift.*

1.  **Airflow Task**: `setup_redshift_external_tables` 
    *   –°—Ç–≤–æ—Ä–µ–Ω–Ω—è `EXTERNAL SCHEMA` –≤ Redshift, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ Glue –±–∞–∑—É `silver`.
2.  **Airflow Task**: `run_enrichment_sql` (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `RedshiftDataOperator`)
    *   –í–∏–∫–æ–Ω–∞–Ω–Ω—è SQL-–∑–∞–ø–∏—Ç—É –≤ Redshift: `INSERT INTO gold.user_profiles_enriched SELECT ... FROM silver_ext.customers JOIN silver_ext.user_profiles ...`
    *   –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –ª–æ–≥—ñ–∫–∏ –∑–±–∞–≥–∞—á–µ–Ω–Ω—è (–∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –ø–æ—Ä–æ–∂–Ω—ñ—Ö —à—Ç–∞—Ç—ñ–≤ —Ç–∞ —ñ–º–µ–Ω).
3.  **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –§—ñ–Ω–∞–ª—å–Ω–∞ —Ç–∞–±–ª–∏—Ü—è –≤ Redshift, –≥–æ—Ç–æ–≤–∞ –¥–æ –∞–Ω–∞–ªv—ñ—Ç–∏–∫–∏.

## üìä –ï—Ç–∞–ø 4: –ê–Ω–∞–ª—ñ—Ç–∏—á–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
1.  **SQL Query**: –§—ñ–Ω–∞–ª—å–Ω–∏–π –∑–∞–ø–∏—Ç –¥–æ Redshift –¥–ª—è –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É —Ç–µ–ª–µ–≤—ñ–∑–æ—Ä—ñ–≤ —É —à—Ç–∞—Ç–∞—Ö —Å–µ—Ä–µ–¥ –ø–æ–∫—É–ø—Ü—ñ–≤ 20-30 —Ä–æ–∫—ñ–≤.

---
### üõ†Ô∏è –©–æ –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–¥–∞—Ç–∏ –≤ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É:
1.  –í `DataPlatform.yml` –¥–æ–¥–∞—Ç–∏ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è Glue Jobs (–¥–ª—è –ï—Ç–∞–ø—É 2).
2.  –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø—É –¥–ª—è Redshift, —â–æ–± –≤—ñ–Ω –º—ñ–≥ —á–∏—Ç–∞—Ç–∏ –∑ S3 (Role `RedshiftServiceRole` –≤–∂–µ —î –≤ —à–∞–±–ª–æ–Ω—ñ).
3.  –ü—ñ–¥–≥–æ—Ç—É–≤–∞—Ç–∏ SQL-—Å–∫—Ä–∏–ø—Ç–∏ –¥–ª—è Redshift.
